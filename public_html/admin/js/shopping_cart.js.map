{"version":3,"sources":["../../../assets_origin/shopping_cart.jsx"],"names":["Component","React","createPortal","render","ReactDOM","ShoppingCart","constructor","props","state","cart","_requestList","bind","_add","_decrement","_remove","_refresh","componentDidMount","$","get","data","setState","JSON","parse","badge","text","total","res","toast","heading","icon","bgColor","position","e","id","preventDefault","post","confirm","currentTarget","getAttribute","hasOwnProperty","Object","keys","items","length","item","map","idx","image","title","width","quantity","sum","Intl","NumberFormat","format","wrap","document","getElementById"],"mappings":"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","sourcesContent":["const {Component} = React;\nconst {createPortal, render} = ReactDOM;\n\nclass ShoppingCart extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            cart: {}\n        };\n\n        this._requestList = this._requestList.bind(this);\n        this._add = this._add.bind(this);\n        this._decrement = this._decrement.bind(this);\n        this._remove = this._remove.bind(this);\n        this._refresh = this._refresh.bind(this);\n    }\n\n    componentDidMount() {\n        this._requestList();\n    }\n\n    _requestList() {\n        $.get('/cart', data => this.setState({cart: JSON.parse(data) || {}}, () => {\n            const {cart} = this.state;\n            if (!cart) return;\n            const badge = $('#cart-badge');\n            $('span', badge).text(cart.total);\n        }));\n    }\n\n    _refresh(res) {\n        if (!res) return;\n        this._requestList();\n        $.toast({\n            heading: 'Giỏ hàng',\n            text: 'Cập nhật thành công',\n            icon: 'success',\n            bgColor: 'green',\n            position: 'bottom-right'\n        });\n    };\n\n    _add(e, id) {\n        e.preventDefault();\n        $.post('/shopping-cart/add', {id: id}, this._refresh);\n        return false;\n    }\n\n    _decrement(e, id) {\n        e.preventDefault();\n        $.post('/shopping-cart/decrement', {id: id}, this._refresh);\n        return false;\n    }\n\n    _remove(e, id) {\n        e.preventDefault();\n        if (confirm('Xác nhận xoá đi sản phẩm này trong giỏ hàng?')) {\n            $.post(e.currentTarget.getAttribute('href'), {id}, this._refresh);\n        }\n        return false;\n    }\n\n    render() {\n        const {cart} = this.state;\n\n        if (!cart || !cart.hasOwnProperty('items') || !Object.keys(cart.items).length) {\n            return (\n                <div className=\"empty-block\">\n                    <img src=\"/images/no-content.jpg\" alt=\"No content\"/>\n                    <h4>Giỏ hàng đang trống </h4>\n                </div>\n            );\n        }\n        let item;\n        return (\n            <div>\n                <table className={'table cart-table table-striped'}>\n                    <thead>\n                    <tr>\n                        <th></th>\n                        <th>Sản phẩm</th>\n                        <th>Số lượng</th>\n                        <th>Đơn giá</th>\n                    </tr>\n                    </thead>\n                    <tbody>\n                    {Object.keys(cart.items).map((idx) => !(item = cart.items[idx]) ? null : (\n                        <tr key={`Item${idx}`}>\n                            <td>\n                                <img src={item.data.image} alt={item.data.title} style={{width: 40}}/>\n                            </td>\n                            <td>{item.data.title}</td>\n                            <td>\n                                <div className={'input-number'}>\n                                    <span className={'cart-qty'}>{item.quantity}</span>\n                                    <span className={'qty-up'} onClick={e => this._add(e, idx)}>+</span>\n                                    <span className={'qty-down'} onClick={e => this._decrement(e, idx)}>-</span>\n                                </div>\n                            </td>\n                            <td>{item.sum ? new Intl.NumberFormat('vi-VN').format(item.sum) : 0} đ</td>\n                            <td>\n                                <a\n                                    className={'cart-remove'}\n                                    href={'/shopping-cart/remove'}\n                                    onClick={e => this._remove(e, idx)}\n                                >\n                                    <i className={'fa fa-trash'}/>\n                                </a>\n                            </td>\n                        </tr>\n                    ))}\n                    </tbody>\n                    <tbody>\n                    <tr>\n                        <td colSpan={3} className={'text-right'}><b>TỔNG TIỀN: </b></td>\n                        <td>{cart.sum ? new Intl.NumberFormat('vi-VN').format(cart.sum) : 0} đ</td>\n                        <td/>\n                    </tr>\n                    </tbody>\n                </table>\n                <div className=\"row\">\n                    <div className=\"col-md-12 text-center\">\n                        <p>\n                            <a href=\"/checkout\" className=\"btn btn-danger btn-custom-red order-submit\">Tính tiền</a>\n                        </p>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nlet wrap;\nif ((wrap = document.getElementById('cart-content'))) {\n    render(<ShoppingCart/>, wrap);\n}"],"file":"shopping_cart.js"}